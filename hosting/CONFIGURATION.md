## Environment Variables

When running a Plausible release, the following configuration parameters can be supplied as environment variables.

### Default User Generation

For self-hosting, a default user can be generated using the `db init-admin` command. In the default docker-compose setup, this command
is run automatically when you boot the server.

It is *highly* recommended that you configure these parameters.

| Parameter        | Default       | Description                          |
|------------------|---------------|--------------------------------------|
| ADMIN_USER_NAME  | autogenerated | Admin user's name                    |
| ADMIN_USER_EMAIL | autogenerated | The default ("admin") user email     |
| ADMIN_USER_PWD   | autogenerated | The default ("admin") user password. |

### Server

Following are the variables that can be used to configure the availability of the server.

| Parameter            | Default     | Description                                                                                                                                                                                         |
|----------------------|-------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| HOST                 | localhost   | The hosting address of the server. For running on local system, this can be set to **localhost**. In production systems, this can be your ingress host.                                             |
| SCHEME               | http        | The scheme of the URL, either `http` or `https`. When using a reverse proxy with https, it'll be required to set this                                                                               |
| PORT                 | 8000        | The port on which the server is available.                                                                                                                                                          |
| SECRET_KEY_BASE      | --          | An internal secret key used by [Phoenix Framework](https://www.phoenixframework.org/). Follow the [instructions](https://hexdocs.pm/phoenix/Mix.Tasks.Phx.Gen.Secret.html#content) to generate one. |
| DISABLE_AUTH         | false       | Disables authentication completely, no registration, login will be shown.                                                                                                                           |
| DISABLE_REGISTRATION | false       | Disables registration of new users, keep your admin credentials handy ;)                                                                                                                            |

### Database

Plausible uses [PostgreSQL as database](https://www.tutorialspoint.com/postgresql/postgresql_environment.htm) for storing all the user-data. Use the following variables to configure it.

| Parameter            | Default                                                   | Description                                                                                                               |
|----------------------|-----------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------|
| DATABASE_URL         | postgres://postgres:postgres@127.0.0.1:5432/plausible_dev | The database URL as dictated [here](https://hexdocs.pm/ecto/Ecto.Repo.html#module-urls)                                   |
| DATABASE_POOL_SIZE   | 10                                                        | Number of connections to the database                                                                                     |
| DATABASE_TLS_ENABLED | false                                                     | A flag that says whether to connect to the database via TLS, read [here](https://www.postgresql.org/docs/10/ssl-tcp.html) |

For performance reasons, all the analytics events are stored in [clickhouse](https://clickhouse.tech/docs/en/getting-started/tutorial/):

| Parameter                    | Default                             | Description                                                                                         |
|------------------------------|-------------------------------------|-----------------------------------------------------------------------------------------------------|
| CLICKHOUSE_DATABASE_URL      | http://localhost:8123/plausible_dev | Connection string for Clickhouse. The protocol is either `http` or `https` depending on your setup. |
| CLICKHOUSE_DATABASE_POOLSIZE | 10                                  | Number of connections to the database                                                               |


### Mailer/SMTP Setup

Plausible uses and SMTP server to send transactional emails e.g. account activation, password reset, weekly reports, etc.

| Parameter             | Default   | Description                                      |
|-----------------------|-----------|--------------------------------------------------|
| MAILER_EMAIL          | hello@plausible.local  | The email id to use for as _from_ address of all communications from Plausible.|
| SMTP_HOST_ADDR        | localhost              | The host address of your smtp server.                                          |
| SMTP_HOST_PORT        | 25                     | The port of your smtp server.                                                  |
| SMTP_USER_NAME        | --                     | The username/email in case SMTP auth is enabled.                               |
| SMTP_USER_PWD         | --                     | The password in case SMTP auth is enabled.                                     |
| SMTP_HOST_SSL_ENABLED | false                  | If SSL is enabled for SMTP connection                                          |
| SMTP_RETRIES          | 2                      | Number of retries to make until mailer gives up.                               |

Alternatively, you can use Postmark to send transactional emails. In this case, use the following parameters:

| Parameter          | Default            | Description                                                                                          |
|--------------------|--------------------|------------------------------------------------------------------------------------------------------|
| MAILER_ADAPTER     | Bamboo.SMTPAdapter | Instead of the default, replace this with `Bamboo.PostmarkAdapter`  |
| POSTMARK_API_KEY   | --                 | Enter your API key.                                                 |


### IP Geolocation

Plausible uses the GeoLite2 database created by [MaxMind](https://www.maxmind.com) for enriching analytics data with visitor countries. Their
end-user license does not make it very easy to just package the database along with an open-source product. This is why, if you want
to get country data for your analytics, you need to create an account and download their **GeoLite2 Country** database.

Once you have the database, mount it on the Plausible docker image and configure the path of the database file:

| Parameter           | Default   | Description                                                                                          |
|---------------------|-----------|------------------------------------------------------------------------------------------------------|
| GEOLITE2_COUNTRY_DB | --        | Path to your IP geolocation database in MaxMind's format  |

To make this as easy as possible you can use the [`maxmindinc/geoipupdate`](https://hub.docker.com/r/maxmindinc/geoipupdate) Docker image.
You just need to add your account details, mount the database in the `plausible` container and let the image update the database automatically.
To run the complete setup including geoip see [`docker-compose-geoip.yml`](docker-compose-geoip.yml#L35).

If the Geolite database is not configured, no country data will be captured.

### External Services

- [Google Client](https://developers.google.com/api-client-library)
    - GOOGLE_CLIENT_ID
    - GOOGLE_CLIENT_SECRET
- [Sentry](https://sentry.io/)
    - SENTRY_DSN
- [Paddle](https://paddle.com/)
    - PADDLE_VENDOR_AUTH_CODE
- [PostMark](https://postmarkapp.com/), only in case of `Bamboo.PostmarkAdapter` mail adapter.
    - POSTMARK_API_KEY

Apart from these, there are also the following integrations

- [Twitter](https://developer.twitter.com/en/docs)
    - TWITTER_CONSUMER_KEY
    - TWITTER_CONSUMER_SECRET
    - TWITTER_ACCESS_TOKEN
    - TWITTER_ACCESS_TOKEN_SECRET
- [Slack](https://api.slack.com/messaging/webhooks)
    - SLACK_WEBHOOK
